<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Dashboard</title>
  </head>
  <body>
    <h1>My Library</h1>
    <button id="openFileDialog">Upload File</button>
    <dialog id="fileDialog">
      <form
        action="/dashboard/<%= folderId %>/upload"
        method="post"
        enctype="multipart/form-data"
      >
        <h1>Upload your file</h1>
        <input type="file" name="file" required />
        <button id="fileCancelBtn">Cancel</button>
        <button type="submit">Upload</button>
      </form>
    </dialog>

    <button id="openFolderDialog">Create Folder</button>
    <dialog id="folderDialog">
      <form action="/dashboard/<%= folderId %>/createFolder" method="post">
        <h1>Create folder</h1>
        <input
          type="text"
          name="folderName"
          placeholder="Folder's name"
          required
        />
        <button id="folderCancelBtn">Cancel</button>
        <button type="submit">Create Folder</button>
      </form>
    </dialog>
    <!-- <a href="/dashboard/upload">Upload file</a> -->
    <a href="/logout">Log out</a>

    <% if (subfolders.length > 0 || files.length > 0){ %>
    <ul>
      <% subfolders.forEach((subfolder) => { %>
      <li>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          width="16"
          height="16"
        >
          <title>folder</title>
          <path
            d="M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"
          />
        </svg>
        <a href="/dashboard/<%=subfolder.id%>"><%=subfolder.name%></a>
        <p><%=subfolder.updatedAt.toString().split("GMT")[0].trim();%></p>
        <p>-</p>
      </li>
      <% }) %>
    </ul>
    <% } else { %>
    <p>This folder is empty.</p>
    <% } %>

    <script>
      const fileBtn = document.getElementById("openFileDialog");
      const fileDialog = document.getElementById("fileDialog");
      const fileCancelBtn = document.getElementById("fileCancelBtn");

      const folderBtn = document.getElementById("openFolderDialog");
      const folderDialog = document.getElementById("folderDialog");
      const folderCancelBtn = document.getElementById("folderCancelBtn");

      fileBtn.addEventListener("click", () => {
        fileDialog.showModal();
      });

      fileCancelBtn.addEventListener("click", () => {
        fileDialog.close();
      });

      folderBtn.addEventListener("click", () => {
        folderDialog.showModal();
      });

      folderCancelBtn.addEventListener("click", () => {
        folderDialog.close();
      });
    </script>
  </body>
</html>
